{% extends 'administration/layout_admin.html.twig' %}

{% block title %}Catégories{% endblock %}


{% block body %}

    <div class="tab-content" id="pills-tabContent">
        <div aria-labelledby="pills-all" class="tab-pane fade show active" id="content-all" role="tabpanel">
            <table aria-describedby="example_info" class="table table-striped table-bordered" id="example" role="grid"
                   style="width: 100%;">
                <thead>
                <tr role="row">


                    <th aria-controls="example" aria-label="lastName: activate to sort column descending"
                        aria-sort="ascending" class="sorting_asc" colspan="1" rowspan="1" style="width: 119px;"
                        tabindex="0">Nom catégorie
                    </th>
                    {% if is_granted('ROLE_ADMIN') %}
                        <th aria-controls="example" aria-label="lastName: activate to sort column descending"
                            aria-sort="ascending" class="sorting_asc" colspan="1" rowspan="1" style="width: 119px;"
                            tabindex="0">Actions
                        </th>
                    {% endif %}
                </tr>
                </thead>
                <tbody>
                {% for category in categories %}

                <tr class="odd" role="row">

                    <td>
                        <font style="text-transform: uppercase;">
                            <span style="size: 300px !important "><strong>{{ category.name }}</strong></span>
                        </font>
                    </td>


                    <!-- Button trigger modal -->
                    <td>

                        <a class="btn btn-warning" href="{{ path('admin_categoryEdit', {id: category.id}) }}" data-toggle="tooltip" data-placement="top" title="Modifier l'activité ou ajouter un créneau">
                            <i class="far fa-edit"></i>
                        </a>
                        <span data-toggle="modal" data-target="#modalDeleteActivity{{ category.id }}">
                            <button type="button" class="btn btn-danger" data-toggle="tooltip" data-placement="top"
                                    title="Supprimer l'activité">
                                <i class="far fa-trash-alt"></i>
                            </button>
                        </span>

                    </td>
                </tr>
                <div class="modal fade" id="modalDeleteActivity{{ category.id }}" tabindex="-1" role="dialog"
                     aria-labelledby="modalDeleteActivityLabel{{ category.id }}" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="modalDeleteActivityLabel{{ category.id }}">Attention</h5>
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                            </div>
                            <div class="modal-body">
                                Êtes-vous sûr de vouloir supprimer cette catégorie ?
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal"
                                        data-toggle="modal">
                                    Non
                                </button>
                                <a href="{{ path('admin_categoryDelete', {id: category.id}) }}" role="button"
                                   class="btn btn-primary">Oui</a>
                            </div>
                        </div>
                    </div>
                    </div>
                    {% endfor %}

                </tbody>
            </table>
        </div>
    </div>

{% endblock %}

{% block javascripts %}
    <script type="text/javascript">
        

        $(document).ready(function () {

            var groupColumn = 2;
            var table = $('#example').DataTable({
                "columnDefs": [
                    {
                        "visible": false,
                        "targets": groupColumn
                    }
                ],
                "order": [
                    [groupColumn, 'asc']
                ],
                "displayLength": 25,
                "drawCallback": function (settings) {
                    var api = this.api();
                    var rows = api.rows({page: 'current'}).nodes();
                    var last = null;

                    api.column(groupColumn, {page: 'current'}).data().each(function (group, i) {
                        if (last !== group) {
                            $(rows).eq(i).before('<tr class="group"><td colspan="5">' + group + '</td></tr>');

                            last = group;
                        }
                    });
                }
            });

            // Order by the grouping
            $('#example tbody').on('click', 'tr.group', function () {
                var currentOrder = table.order()[0];
                if (currentOrder[0] === groupColumn && currentOrder[1] === 'asc') {
                    table.order([groupColumn, 'desc']).draw();
                } else {
                    table.order([groupColumn, 'asc']).draw();
                }
            });
        });</script>{% endblock %}
