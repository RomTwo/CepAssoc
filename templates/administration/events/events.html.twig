{% extends 'administration/base.html.twig' %}

{% block title %}Adherents{% endblock %}

{% block specification %}
    Gestion des évènements
{% endblock %}


{% block body %}
    <!-- Button who print the event form -->
    <div class="row justify-content-center mb-2">
        <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#addEvent"
                aria-expanded="false" aria-controls="addEvent">
            Ajouter un évènement
        </button>
    </div>

    <!-- Form add event and add job -->
    {% include('administration/events/addEventForm.html.twig') %}

    <!-- DataTable -->
    <table id="events" class="table table-striped table-bordered" style="width:100%">
        <thead>
        <tr>
            <th>Nom</th>
            <th>Début</th>
            <th>Fin</th>
            <th>Adresse</th>
            <th>Description</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody>
        {% for event in events %}
            <tr>
                <td>{{ event.name }}</td>
                <td>le {{ event.startDate | date("m/d/Y H:i") }}</td>
                <td>le {{ event.endDate | date("m/d/Y H:i") }}</td>
                <td>{{ event.address }}</td>
                <td>{{ event.description }}</td>
                <td>
                    <button type="button" class="btn btn-primary" data-toggle="modal"
                            data-target="#deleteEvent{{ event.id }}">
                        <i class="far fa-calendar-alt"></i>
                    </button>
                    <a class="btn btn-warning" href="{{ path('admin_event_update', {'id': event.id}) }}"><i
                                class="far fa-edit"></i></a>
                    <button type="button" class="btn btn-danger" data-toggle="modal"
                            data-target="#modalDeleteEvent{{ event.id }}">
                        <i class="far fa-trash-alt"></i>
                    </button>
                </td>
            </tr>
        {% endfor %}
        </tbody>
        <tfoot>
        <tr>
            <th>Nom</th>
            <th>Début</th>
            <th>Fin</th>
            <th>Adresse</th>
            <th>Description</th>
            <th>Action</th>
        </tr>
        </tfoot>
    </table>

    <table border="0" cellpadding="0" cellspacing="0">
        <tbody>
        <tr>
            <td class="gutter">
                <div class="line number1 index0 alt2" style="display: none;">1</div>
            </td>
            <td class="code">
                <div class="container" style="display: none;">
                    <div class="line number1 index0 alt2" style="display: none;">&nbsp;</div>
                </div>
            </td>
        </tr>
        </tbody>
    </table>

    <!-- Modal -->
    {% for event in events %}
        {% include('administration/events/modalDeleteEvent.html.twig') %}
    {% endfor %}


{% endblock %}


{% block javascripts %}
    <script>
        $(document).ready(function () {
            $('#events').DataTable();
        });

        $(document).ready(function () {
            $('#divAddJob').hide();
            $('#addJob').click(function () {
                $('#divAddJob').toggle("slide");
            })
        });


        $('#jobForm').submit(function (e) {
            e.preventDefault();
            let form_data = $(this).serialize();
            $.ajax({
                url: '{{ path('job_add') }}',
                type: 'POST',
                data: form_data,
                success: function (json) {
                    let div = "<div class='form-check'>" +
                        "<input type='checkbox' id='event_jobs_" + json.id + "' name='event[jobs][]' class='form-check-input' value='" + json.id + "'>" +
                        "<label class='form-check-label' for='event_jobs_" + json.id + "'>" + json.name + "</label>" +
                        "</div>";


                    $('#jobName').val('');
                    $('#divAddJob').hide();
                    $('#event_jobs').append(div);
                }
            })
        })
    </script>
{% endblock %}
